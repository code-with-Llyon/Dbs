{% extends "base.html" %} {% block content %}
<h2 class="mb-3">Upload Document</h2>

{# show flash messages from Flask #} {% with messages =
get_flashed_messages(with_categories=true) %} {% if messages %} {% for category,
msg in messages %}
<div
  class="alert alert-{{ category }} alert-dismissible fade show"
  role="alert"
>
  {{ msg }}
  <button
    type="button"
    class="btn-close"
    data-bs-dismiss="alert"
    aria-label="Close"
  ></button>
</div>
{% endfor %} {% endif %} {% endwith %}

<form id="uploadForm" method="POST" enctype="multipart/form-data">
  <div class="mb-3">
    <label class="form-label">Purpose</label>
    <select id="purpose" name="purpose" class="form-select" required>
      <option value="">-- Select Purpose --</option>
      <option value="study">Study</option>
      <option value="work">Work</option>
    </select>
  </div>

  <div class="mb-3">
    <label class="form-label">Category</label>
    <select id="category" name="category" class="form-select" required>
      <option value="">-- Select Category --</option>
      {# options will be filled by JS based on purpose #}
    </select>
  </div>

  <div class="mb-3">
    <label class="form-label">Document Type</label>
    <select id="doc_type" name="doc_type" class="form-select" required>
      <option value="">-- Select Document --</option>
      {# also filled by JS based on purpose + category, or you can hard-code
      options #}
    </select>
  </div>

  <div class="mb-3">
    <label class="form-label">Expiry Date (Passport only)</label>
    <input
      type="date"
      id="expiry_date"
      name="expiry_date"
      class="form-control"
      placeholder="YYYY-MM-DD"
    />
  </div>

  <div class="mb-3">
    <label class="form-label">Upload File</label>
    <input
      type="file"
      id="document"
      name="document"
      class="form-control"
      accept=".pdf,.jpg,.jpeg,.png"
      required
    />
    <div class="form-text">
      Allowed types: PDF, JPG, JPEG, PNG. Max size: 5MB.
    </div>
  </div>

  <div id="requiredDocsBox" class="alert alert-info d-none"></div>

  <button type="submit" class="btn btn-primary">Upload</button>
</form>

<div id="js-feedback" class="mt-3"></div>

<script src="{{ url_for('static', filename='js/validation.js') }}"></script>
{% endblock %}
